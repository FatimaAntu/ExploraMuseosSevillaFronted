<form #form="ngForm" (ngSubmit)="enviarMensaje(form)" novalidate
      class="max-w-md mx-auto bg-gray-900 p-6 rounded-lg shadow-lg text-white">

  <h2 class="text-3xl font-bold mb-6 text-center">Contacto</h2>

  <div class="mb-4">
    <label for="nombre" class="block mb-2 font-semibold">Nombre</label>
    <input
      id="nombre"
      name="nombre"
      type="text"
      [(ngModel)]="nombre"
      required
      #nombreInput="ngModel"
      [ngClass]="{
        'border border-red-500': nombreInput.invalid && (nombreInput.touched || formSubmitAttempt),
        'border border-gray-700': !(nombreInput.invalid && (nombreInput.touched || formSubmitAttempt))
      }"
      class="w-full px-3 py-2 rounded bg-gray-800 text-white focus:outline-none focus:border-teal-500 transition"
      autocomplete="off"
    />
    <div *ngIf="nombreInput.invalid && (nombreInput.touched || formSubmitAttempt)" 
         class="text-red-500 text-sm mt-1">
      El nombre es obligatorio.
    </div>
  </div>

  <div class="mb-4">
    <label for="email" class="block mb-2 font-semibold">Email</label>
    <input
      id="email"
      name="email"
      type="email"
      [(ngModel)]="email"
      required
      email
      #emailInput="ngModel"
      [ngClass]="{
        'border border-red-500': emailInput.invalid && (emailInput.touched || formSubmitAttempt),
        'border border-gray-700': !(emailInput.invalid && (emailInput.touched || formSubmitAttempt))
      }"
      class="w-full px-3 py-2 rounded bg-gray-800 text-white focus:outline-none focus:border-teal-500 transition"
      autocomplete="off"
    />
    <div *ngIf="emailInput.invalid && (emailInput.touched || formSubmitAttempt)" 
         class="text-red-500 text-sm mt-1">
      Por favor, introduce un email válido.
    </div>
  </div>

  <div class="mb-4">
    <label for="mensaje" class="block mb-2 font-semibold">Mensaje</label>
    <textarea
      id="mensaje"
      name="mensaje"
      rows="4"
      [(ngModel)]="mensaje"
      required
      #mensajeInput="ngModel"
      [ngClass]="{
        'border border-red-500': mensajeInput.invalid && (mensajeInput.touched || formSubmitAttempt),
        'border border-gray-700': !(mensajeInput.invalid && (mensajeInput.touched || formSubmitAttempt))
      }"
      class="w-full px-3 py-2 rounded bg-gray-800 text-white focus:outline-none focus:border-teal-500 resize-none transition"
    ></textarea>
    <div *ngIf="mensajeInput.invalid && (mensajeInput.touched || formSubmitAttempt)" 
         class="text-red-500 text-sm mt-1">
      El mensaje es obligatorio.
    </div>
  </div>

  <button
    type="submit"
    [disabled]="form.invalid || enviando"
    class="w-full bg-teal-600 hover:bg-teal-700 text-white font-bold py-2 rounded disabled:opacity-50 disabled:cursor-not-allowed transition flex justify-center items-center gap-2"
  >
    <span *ngIf="!enviando">Enviar</span>
    <span *ngIf="enviando" class="animate-spin border-2 border-white border-t-transparent rounded-full w-5 h-5"></span>
    <span *ngIf="enviando">Enviando...</span>
  </button>

  <div *ngIf="mensajeEnviado" 
       class="mt-6 bg-green-700 text-green-100 p-4 rounded shadow text-center font-semibold">
    ¡Gracias por tu mensaje! Te responderemos pronto.
  </div>
  <div *ngIf="errorEnvio" 
     class="mt-6 bg-red-700 text-red-100 p-4 rounded shadow text-center font-semibold">
  Lo sentimos, ha ocurrido un error al enviar el mensaje. Por favor, inténtalo de nuevo.
</div>

</form>
